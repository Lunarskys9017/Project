{"ast":null,"code":"class Consumer {\n  constructor(stream, id, startNode, timeout) {\n    this.id = id;\n    this._backpressure = 0;\n    this.currentNode = startNode;\n    this.timeout = timeout;\n    this.isAlive = true;\n    this.stream = stream;\n    this.stream.setConsumer(this.id, this);\n  }\n  getStats() {\n    let stats = {\n      id: this.id,\n      backpressure: this._backpressure\n    };\n    if (this.timeout != null) {\n      stats.timeout = this.timeout;\n    }\n    return stats;\n  }\n  _resetBackpressure() {\n    this._backpressure = 0;\n  }\n  applyBackpressure(packet) {\n    this._backpressure++;\n  }\n  releaseBackpressure(packet) {\n    this._backpressure--;\n  }\n  getBackpressure() {\n    return this._backpressure;\n  }\n  clearActiveTimeout() {\n    clearTimeout(this._timeoutId);\n    delete this._timeoutId;\n  }\n  write(packet) {\n    if (this._timeoutId !== undefined) {\n      this.clearActiveTimeout(packet);\n    }\n    this.applyBackpressure(packet);\n    if (this._resolve) {\n      this._resolve();\n      delete this._resolve;\n    }\n  }\n  kill(value) {\n    this._killPacket = {\n      value,\n      done: true\n    };\n    if (this._timeoutId !== undefined) {\n      this.clearActiveTimeout(this._killPacket);\n    }\n    this._destroy();\n    if (this._resolve) {\n      this._resolve();\n      delete this._resolve;\n    }\n  }\n  _destroy() {\n    this.isAlive = false;\n    this._resetBackpressure();\n    this.stream.removeConsumer(this.id);\n  }\n  async _waitForNextItem(timeout) {\n    return new Promise((resolve, reject) => {\n      this._resolve = resolve;\n      let timeoutId;\n      if (timeout !== undefined) {\n        // Create the error object in the outer scope in order\n        // to get the full stack trace.\n        let error = new Error('Stream consumer iteration timed out');\n        (async () => {\n          let delay = wait(timeout);\n          timeoutId = delay.timeoutId;\n          await delay.promise;\n          error.name = 'TimeoutError';\n          delete this._resolve;\n          reject(error);\n        })();\n      }\n      this._timeoutId = timeoutId;\n    });\n  }\n  async next() {\n    this.stream.setConsumer(this.id, this);\n    while (true) {\n      if (!this.currentNode.next) {\n        try {\n          await this._waitForNextItem(this.timeout);\n        } catch (error) {\n          this._destroy();\n          throw error;\n        }\n      }\n      if (this._killPacket) {\n        this._destroy();\n        let killPacket = this._killPacket;\n        delete this._killPacket;\n        return killPacket;\n      }\n      this.currentNode = this.currentNode.next;\n      this.releaseBackpressure(this.currentNode.data);\n      if (this.currentNode.consumerId && this.currentNode.consumerId !== this.id) {\n        continue;\n      }\n      if (this.currentNode.data.done) {\n        this._destroy();\n      }\n      return this.currentNode.data;\n    }\n  }\n  return() {\n    delete this.currentNode;\n    this._destroy();\n    return {};\n  }\n  [Symbol.asyncIterator]() {\n    return this;\n  }\n}\nfunction wait(timeout) {\n  let timeoutId;\n  let promise = new Promise(resolve => {\n    timeoutId = setTimeout(resolve, timeout);\n  });\n  return {\n    timeoutId,\n    promise\n  };\n}\nmodule.exports = Consumer;","map":{"version":3,"names":["Consumer","constructor","stream","id","startNode","timeout","_backpressure","currentNode","isAlive","setConsumer","getStats","stats","backpressure","_resetBackpressure","applyBackpressure","packet","releaseBackpressure","getBackpressure","clearActiveTimeout","clearTimeout","_timeoutId","write","undefined","_resolve","kill","value","_killPacket","done","_destroy","removeConsumer","_waitForNextItem","Promise","resolve","reject","timeoutId","error","Error","delay","wait","promise","name","next","killPacket","data","consumerId","return","Symbol","asyncIterator","setTimeout","module","exports"],"sources":["C:/Users/bryan/Desktop/Projects/my-app/node_modules/writable-consumable-stream/consumer.js"],"sourcesContent":["class Consumer {\n  constructor(stream, id, startNode, timeout) {\n    this.id = id;\n    this._backpressure = 0;\n    this.currentNode = startNode;\n    this.timeout = timeout;\n    this.isAlive = true;\n    this.stream = stream;\n    this.stream.setConsumer(this.id, this);\n  }\n\n  getStats() {\n    let stats = {\n      id: this.id,\n      backpressure: this._backpressure\n    };\n    if (this.timeout != null) {\n      stats.timeout = this.timeout;\n    }\n    return stats;\n  }\n\n  _resetBackpressure() {\n    this._backpressure = 0;\n  }\n\n  applyBackpressure(packet) {\n    this._backpressure++;\n  }\n\n  releaseBackpressure(packet) {\n    this._backpressure--;\n  }\n\n  getBackpressure() {\n    return this._backpressure;\n  }\n\n  clearActiveTimeout() {\n    clearTimeout(this._timeoutId);\n    delete this._timeoutId;\n  }\n\n  write(packet) {\n    if (this._timeoutId !== undefined) {\n      this.clearActiveTimeout(packet);\n    }\n    this.applyBackpressure(packet);\n    if (this._resolve) {\n      this._resolve();\n      delete this._resolve;\n    }\n  }\n\n  kill(value) {\n    this._killPacket = {value, done: true};\n    if (this._timeoutId !== undefined) {\n      this.clearActiveTimeout(this._killPacket);\n    }\n    this._destroy();\n\n    if (this._resolve) {\n      this._resolve();\n      delete this._resolve;\n    }\n  }\n\n  _destroy() {\n    this.isAlive = false;\n    this._resetBackpressure();\n    this.stream.removeConsumer(this.id);\n  }\n\n  async _waitForNextItem(timeout) {\n    return new Promise((resolve, reject) => {\n      this._resolve = resolve;\n      let timeoutId;\n      if (timeout !== undefined) {\n        // Create the error object in the outer scope in order\n        // to get the full stack trace.\n        let error = new Error('Stream consumer iteration timed out');\n        (async () => {\n          let delay = wait(timeout);\n          timeoutId = delay.timeoutId;\n          await delay.promise;\n          error.name = 'TimeoutError';\n          delete this._resolve;\n          reject(error);\n        })();\n      }\n      this._timeoutId = timeoutId;\n    });\n  }\n\n  async next() {\n    this.stream.setConsumer(this.id, this);\n\n    while (true) {\n      if (!this.currentNode.next) {\n        try {\n          await this._waitForNextItem(this.timeout);\n        } catch (error) {\n          this._destroy();\n          throw error;\n        }\n      }\n      if (this._killPacket) {\n        this._destroy();\n        let killPacket = this._killPacket;\n        delete this._killPacket;\n\n        return killPacket;\n      }\n\n      this.currentNode = this.currentNode.next;\n      this.releaseBackpressure(this.currentNode.data);\n\n      if (this.currentNode.consumerId && this.currentNode.consumerId !== this.id) {\n        continue;\n      }\n\n      if (this.currentNode.data.done) {\n        this._destroy();\n      }\n\n      return this.currentNode.data;\n    }\n  }\n\n  return() {\n    delete this.currentNode;\n    this._destroy();\n    return {};\n  }\n\n  [Symbol.asyncIterator]() {\n    return this;\n  }\n}\n\nfunction wait(timeout) {\n  let timeoutId;\n  let promise = new Promise((resolve) => {\n    timeoutId = setTimeout(resolve, timeout);\n  });\n  return {timeoutId, promise};\n}\n\nmodule.exports = Consumer;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}