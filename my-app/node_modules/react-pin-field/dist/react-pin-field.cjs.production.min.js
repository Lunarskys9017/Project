"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("react"),n=(e=t)&&"object"==typeof e&&"default"in e?e.default:e,r=require("react-use-bireducer");function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var o,u={3:"Cancel",6:"Help",8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",28:"Convert",29:"NonConvert",30:"Accept",31:"ModeChange",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",41:"Select",42:"Print",43:"Execute",44:"PrintScreen",45:"Insert",46:"Delete",48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],91:"OS",93:"ContextMenu",106:"*",107:"+",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",181:"VolumeMute",182:"VolumeDown",183:"VolumeUp",186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"'],224:"Meta",225:"AltGraph",246:"Attn",247:"CrSel",248:"ExSel",249:"EraseEof",250:"Play",251:"ZoomOut"};for(o=1;o<25;o+=1)u[111+o]="F"+o;for(o=65;o<91;o+=1){var c=String.fromCharCode(o);u[o]=[c.toLowerCase(),c.toUpperCase()]}for(o=96;o<106;o+=1)u[o]=String.fromCharCode(o-48);function i(){}function l(e,t){return Array.from({length:t},(function(t,n){return n+e}))}var s=["refs"],d=[],f=["autoFocus","length","validate","format","debug"],p=["onResolveKey","onRejectKey","onChange","onComplete"],y=["Alt","Control","Enter","Meta","Shift","Tab"],x={ref:{current:[]},length:5,validate:/^[a-zA-Z0-9]$/,format:function(e){return e},onResolveKey:i,onRejectKey:i,onChange:i,onComplete:i,debug:!1};function v(e){return{focusIdx:0,codeLength:e.length,isKeyAllowed:k(e.validate),fallback:null}}function h(e){return Math.max(0,e-1)}function g(e,t){return 0===t?0:Math.min(e+1,t-1)}function k(e){return function(t){return!!t&&!(t.length>1)&&("string"==typeof e?e.split("").includes(t):e instanceof Array?e.includes(t):e instanceof RegExp?e.test(t):e(t))}}function m(e,t,n){if(!n.split("").slice(0,e.codeLength).every(e.isKeyAllowed))return[e,[{type:"set-input-val",idx:e.focusIdx,val:""},{type:"reject-key",idx:t,key:n},{type:"handle-code-change"}]];var r=Math.min(n.length,e.codeLength-e.focusIdx),o=g(r+e.focusIdx-1,e.codeLength),u=l(0,r).flatMap((function(t){return[{type:"set-input-val",idx:t+e.focusIdx,val:n[t]},{type:"resolve-key",idx:t+e.focusIdx,key:n[t]}]}));return e.focusIdx!==o&&u.push({type:"focus-input",idx:o}),u.push({type:"handle-code-change"}),[a({},e,{focusIdx:o}),u]}var C=function(e,t){switch(t.type){case"handle-key-down":switch(t.key){case"Unidentified":return[a({},e,{fallback:{idx:e.focusIdx,val:t.val}}),d];case"Dead":return[e,[{type:"set-input-val",idx:e.focusIdx,val:""},{type:"reject-key",idx:e.focusIdx,key:t.key},{type:"handle-code-change"}]];case"ArrowLeft":var n=h(e.focusIdx);return[a({},e,{focusIdx:n}),[{type:"focus-input",idx:n}]];case"ArrowRight":var r=g(e.focusIdx,e.codeLength);return[a({},e,{focusIdx:r}),[{type:"focus-input",idx:r}]];case"Delete":case"Backspace":return[e,[{type:"handle-delete",idx:e.focusIdx},{type:"handle-code-change"}]];default:if(!e.isKeyAllowed(t.key))return[e,[{type:"reject-key",idx:e.focusIdx,key:t.key}]];var o=g(e.focusIdx,e.codeLength);return[a({},e,{focusIdx:o}),[{type:"set-input-val",idx:e.focusIdx,val:t.key},{type:"resolve-key",idx:e.focusIdx,key:t.key},{type:"focus-input",idx:o},{type:"handle-code-change"}]]}case"handle-key-up":if(!e.fallback)return[e,d];var u=a({},e,{fallback:null}),c=[],i=e.fallback,l=i.idx,s=i.val,f=t.val;if(""===s&&""===f)c.push({type:"handle-delete",idx:l},{type:"handle-code-change"});else if(""===s&&""!==f)return m(u,l,f);return[u,c];case"handle-paste":return m(e,t.idx,t.val);case"focus-input":return[a({},e,{focusIdx:t.idx}),[{type:"focus-input",idx:t.idx}]];default:return[e,d]}};function I(e){var n=e.refs,r=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t.indexOf(n=o[r])>=0||(a[n]=e[n]);return a}(e,s);return t.useCallback((function(e){switch(e.type){case"focus-input":n.current[e.idx].focus();break;case"set-input-val":var t=r.format(e.val);n.current[e.idx].value=t;break;case"resolve-key":n.current[e.idx].setCustomValidity(""),r.onResolveKey(e.key,n.current[e.idx]);break;case"reject-key":n.current[e.idx].setCustomValidity("Invalid key"),r.onRejectKey(e.key,n.current[e.idx]);break;case"handle-delete":var a=n.current[e.idx].value;if(n.current[e.idx].setCustomValidity(""),n.current[e.idx].value="",!a){var o=h(e.idx);n.current[o].focus(),n.current[o].setCustomValidity(""),n.current[o].value=""}break;case"handle-code-change":var u=(r.dir||document.documentElement.getAttribute("dir")||"ltr").toLowerCase(),c=n.current.map((function(e){return e.value.trim()})),i=("rtl"===u?c.reverse():c).join("");r.onChange(i),i.length===r.length&&r.onComplete(i)}}),[r,n])}var b=t.forwardRef((function(e,o){var c=a({},x,e),i=c.autoFocus,s=c.length,d=function(e,t){var n=Object.create({});for(var r in t){var a;e.includes(r)||Object.assign(n,((a={})[r]=t[r],a))}return n}([].concat(f,p),c),h=t.useRef([]),g=I(a({refs:h},c)),k=r.useBireducer(C,g,v(c))[1];function m(e){return function(){k({type:"focus-input",idx:e})}}function b(e){return function(t){var n=function(e){if(e.key&&"Unidentified"!==e.key)return e.key;var t=u[e.which||e.keyCode]||"Unidentified";return Array.isArray(t)?t[+(e.shiftKey||0)]:t}(t.nativeEvent);y.includes(n)||t.ctrlKey||t.altKey||t.metaKey||!(t.nativeEvent.target instanceof HTMLInputElement)||(t.preventDefault(),k({type:"handle-key-down",idx:e,key:n,val:t.nativeEvent.target.value}))}}function E(e){return function(t){t.nativeEvent.target instanceof HTMLInputElement&&k({type:"handle-key-up",idx:e,val:t.nativeEvent.target.value})}}function w(e){return function(t){t.preventDefault();var n=t.clipboardData.getData("Text");k({type:"handle-paste",idx:e,val:n})}}function A(e){return function(t){t&&(h.current[e]=t)}}function K(e){return Boolean(0===e&&i)}return t.useImperativeHandle(o,(function(){return h.current}),[h]),n.createElement(n.Fragment,null,l(0,s).map((function(e){return n.createElement("input",Object.assign({type:"text",autoCapitalize:"off",autoCorrect:"off",autoComplete:"off",inputMode:"text"},d,{key:e,ref:A(e),autoFocus:K(e),onFocus:m(e),onKeyDown:b(e),onKeyUp:E(e),onPaste:w(e)}))})))}));exports.HANDLER_KEYS=p,exports.IGNORED_META_KEYS=y,exports.NO_EFFECTS=d,exports.PROP_KEYS=f,exports.PinField=b,exports.default=b,exports.defaultProps=x,exports.defaultState=v,exports.getNextFocusIdx=g,exports.getPrevFocusIdx=h,exports.isKeyAllowed=k,exports.pasteReducer=m,exports.stateReducer=C,exports.useEffectReducer=I;
//# sourceMappingURL=react-pin-field.cjs.production.min.js.map
